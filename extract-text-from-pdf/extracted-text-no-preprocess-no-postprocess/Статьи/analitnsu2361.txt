

--- Страница 1 ---

УДК 303.094.7
JEL C63, 041

Е. А. Рашидова

Новосибирский национальный исследовательский
государственный университет
ул. Пирогова, 1, Новосибирск, 630090, Россия

lizarashidova@gmail.com

АГЕНТ-ОРИЕНТИРОВАННОЕ МОДЕЛИРОВАНИЕ
ОПТОВОГО РЫНКА ЭЛЕКТРОЭНЕРГИИ РОССИИ *

Статья посвящена исследованию свободного рынка электроэнергии с помощью агент-ориентированного мо-
делирования Целью было создание простого и достаточно правдоподобного симулятора рынка, где поставщики
и покупатели, участвуя в двустороннем аукционе, обучаются подавать самые выгодные для них заявки Такого
рода симулятор еще не создан для российского рынка, но зарубежными учеными уже разработаны симуляторы
для рынков ЕС и США Построена теоретическая имитационная модель взаимодействия агентов на рынке на су-
тки вперед с обучением по алгоритму Эрева — Рота, а затем проведены экспериментальные расчеты, симулирую-
щие работу рынка На основе полученных расчетов проведен анализ равновесных цен, объемов, общественного
выигрыша и его распределения между покупателями и продавцами электроэнергии Результатом работы стало
предположение о том, что, если разрешить агентам, которые способны обучаться, подавать любые заявки на этом
рынке, это позволило бы покупателям приобретать тот же объем по более низкой цене и, таким образом, перерас-
пределить общественный выигрыш в пользу покупателей

Ключевые слова агент-ориентированное моделирование, обучение агентов, оптовый рынок электроэнергии,
рынок на сутки вперед

Введение

С каждым годом объем потребления электроэнергии на душу населения в России растет.
Отметим, что в России огромный неиспользованный потенциал энергосбережения. Сейчас
перед государством стоит цель сократить неэффективное потребление. Свободный рынок
электроэнергии является попыткой создания стимулов к этому. Очевидно, что более эффек-
тивное взаимодействие агентов (потребители, компании, государство) может изменить эту
ситуацию в лучшую сторону, что, безусловно, будет являться позитивными социальными
переменами. Либерализация рынка электроэнергии в России произошла в 2011 г. УЕСи США
она проходила в девяностых годах прошлого века.

Основные энергетические мощности и объекты электроэнергетики России были построе-
ны в эпоху СССР. После перестройки и переходного периода отрасль находилась в упадке
(если сравнивать с ее состоянием в советское время или с отраслями других развитых стран.)
Электроэнергетика требовала срочных изменений, которые способствовали бы обновлению

* > С С
В статье представлены результаты магистерской диссертации Е А Рашидовой, занявшей первое место
в Конкурсе на лучшую выпускную квалификационную работу по экономике за 2016 г среди выпускников эконо-
мических вузов и экономических факультетов высших учебных заведений России

Рашидова Е. А. Агент-ориентированное моделирование оптового рынка электроэнергии России // Мир экономики
и управления 2017 T 17, №ТС 70-85

ISSN 2542-0429. Мир экономики и управления. 2017. Том 17, № 1
СЕ А. Рашидова, 2017


--- Страница 2 ---

Рашидова Е. А. Агенториентированное моделирование оптового рынка электроэнергии 71

основных мощностей, повышению эффективности отрасли. Целью реформы было привлече-
ние в отрасль инвестиций. Правительством РФ в начале 2000-х гг. был взят курс на либера-
лизацию рынка электроэнергии '

Запланированная реформа проводилась в период с 2001 по 2008 г. Внесенные изменения
позволили увеличить объем инвестиций в отрасль и обеспечить в дальнейшем надежность
энергоснабжения. Наиболее значимым преобразованием отрасли стало создание свободного
рынка электроэнергии и мощности. Целью являлось создание свободного оптового рынка
электроэнергии. Главной задачей реформы было эффективное расформирование вертикально
интегрированной компании, являющейся монополистом на рынке — РАО ЕЭС. С 1 января
2011 г. оптовый рынок электроэнергии и мощности был полностью либерализован.

Так как рынок существует недолго, неизвестно, какие кризисы могут его ожидать. За вре-
мя существования свободного рынка США столкнулись с серьезными для стратегически
важной отрасли проблемами. К ним можно отнести Калифорнийский кризис 2000 г. и другие
подобные кризисы, когда цены резко возрастали в несколько тысяч раз, а также спекуляция
электроэнергией «Епгоп» и последующее банкротство этой крупнейшей энергетической ком-
пании. Эти кризисы показали, что может случиться, когда плохо разработанный рыночный
механизм реализован без надлежащего тестирования. Рынок России не застрахован от по-
добных кризисов, поэтому необходимо исследовать природу действий участников, используя
опыт ЕС и США, т. е. тех стран, на чей опыт опирались при создании свободного рынка
в России.

В статье [1] авторы выделили четыре основных направления анализа взаимодействия ме-
жду участниками рынка электроэнергии в современных исследованиях:

‚ ¢€X-post анализ существующего рынка;

e ex-ante анализ рыночной структуры (концентрации на рынке);

‚ статические модели равновесия на рынке;

‚ агент-ориентированное моделирование рынка.

Данная работа посвящается именно агент-ориентированному моделированию рынка. Ин-
терес к данной теме возрастает с каждым годом. Фундаментальными трудами в данной об-
ласти принято считать исследования Даниэля Канемана (Daniel Kahneman) и Амоса Тверски
(Amos Tversky), которые показали, что в действительности лица, принимающие решения,
плохо справляются с задачами логического анализа, зато достаточно успешны в быстром
распознавании шаблонов поведения, часто интерпретация информации основана собствен-
ном опыте и интуитивных решениях [2].

На протяжении многих лет экономисты изучали, как принимаются решения с помощью
моделей, предполагающих полную информацию и рациональное поведение участников. Од-
нако последние пятнадцать лет исследователи все чаще стараются работать с моделями, где
нет таких строгих предпосылок. Для этого стали использоваться агент-ориентированные мо-
дели, относящиеся к классу моделей, основанных на индивидуальном поведении агентов
и создаваемые для компьютерных симуляций. Таким образом, модель представляет собой
совокупность агентов с определенным набором свойств, благодаря чему есть возможность
проводить симуляции реальных явлений [3].

Согласно статье [4] существует три основных преимущества агент-ориентированного мо-
делирования:

. учет явлений, возникающих вследствие взаимодействия агентов, которые могут обла-
дать свойствами, не присущими ни одному из агентов;

. обеспечение наиболее близкого к реальности описание системы, если она состоит
из набора субъектов / объектов, совершающих какие-либо действия;

. гибкость, что позволяет вводить новых агентов, усложнять их поведение, менять их
способность учиться и развиваться.

Также в статье [4] указаны ситуации, когда может быть полезным использование агент-
ориентированных моделей:

' Электроэнергетика отрасль URL http /Ammenergo gov ru/activity/powerindustry/powersector/ (дата обращения
20 05 2015)


--- Страница 3 ---

72 Микроэкономический анализ: методы и результаты

e взаимодействие между агентами является достаточно сложным (нелинейным, беско-
нечным, дискретным);

. пространство играет важную роль, и агенты способны перемещаться;

. у атентов достаточно сложное поведение, включающее в себя обучение и адаптацию
к окружающей среде.

Сказанное соответствует ситуации на свободном рынке электроэнергии. В качестве аген-
тов, принимающих решения, могут выступать производители и покупатели электроэнергии.
Они соответствуют основным требованиям, предъявляемым к агентам в статье [5]: они авто-
номны, взаимодействуют друг с другом, а также восприимчивы к окружающей среде, что
выражается в сборе информации о собственном состоянии, о конкурентах, о ситуации
на рынке, перед совершением какого-либо действия. Кроме того, они проактивны, так как
способны пробовать совершать различные действия, чтобы увеличивать свою прибыль.

За рубежом агент-ориентированное моделирование свободных рынков электроэнергии
проводится, но сравнительно слабо отражается в литературе. Причиной этого, возможно,
служит необычное сочетание сложного и специфического рынка с достаточно новым подхо-
дом к моделированию. Работы можно сгруппировать по странам, чей свободный рынок явля-
ется объектом исследований. В США создана целая лаборатория [6] под руководством
Л. Тесфатсион (L. Tesfatsion) по агент-ориентированному моделированию оптового рынка
электроэнергии [7]. Отличие этих исследований от прочих заключается в том, что в лабора-
тории идет совместная работа физиков и экономистов [8]. Группа европейских ученых во
главе с Дж. Бауэром (J. Bower) [9], Д. Банном (О. W. Bunn) [10], А. Вейдличем (А. Weidlich)
ПИ и Д. Веитом (О. Veit) [12] активно исследует свободный рынок Германии и рынок EC
в целом. Бауэром и Банном также исследуется британский рынок, а именно итоги реформи-
рования уже имеющегося свободного рынка, куда был добавлен сектор свободных догово-
ров, функционирующий в режиме реального времени [13]. Также есть небольшая группа ки-
тайских ученых, которые пока не анализируют свой рынок, а изучают имеющиеся работы
[14] и предлагают их модификации [15]. Основными целями работ является создание симу-
ляторов рынков, анализ эффективности механизмов ценообразования, создание и модифика-
ция подходящих алгоритмов обучения агентов на рынке, а также введение случайных факто-
ров в уже существующие модели. В России на данный момент, насколько мне известно, не
имеется работ, где была бы создана или проанализирована агент-ориентированная модель
свободного рынка электроэнергии.

Рынок на сутки вперед
на рынке электроэнергии в России

Опишем оптовый рынок электроэнергии России. Существует три группы субъектов опто-
вого рынка электроэнергии (ОРЭ):

1) поставщики электрической энергии;

2) покупатели электрической энергии;

3) инфраструктурные организации.

К поставщикам относят только владельцев генерирующего оборудования. Иначе говоря,
это генерирующие компании, такие как ТГК, ОГК, «РусГидро», которым принадлежат элек-
тростанции.

Можно выделить пять групп покупателей:

1) энергосбытовые организации (покупают энергию на ОРЭ и продают на розничном
рынке мелким потребителям по самостоятельно установленной цене);

2) крупные потребители (крупные заводы);

3) гарантирующие поставщики (покупают энергию на ОРЭ и продают ее населению
по цене, устанавливаемой ФСТ);

4) организации, осуществляющие экспортно-импортные операции;

5) территориальные сетевые организации в целях осуществления функций гарантирую-
щего поставщика.

К инфраструктурным организациям относят следующие:

1) системный оператор (СО) Единой энергетической системы;


--- Страница 4 ---

Рашидова Е. А. Агенториентированное моделирование оптового рынка электроэнергии 73

2) федеральная сетевая компания (ФСК) Единой энергетической системы;

3) некоммерческое партнерство «Совет рынка по организации эффективной системы оп-
товой и розничной торговли электрической энергией и мощностью» (Совет рынка);

4) администратор торговой системы (АТС) оптового рынка электроэнергии.

Оптовый рынок электроэнергии России состоит из четырех секторов, которые различают-
ся по взаимодействию между участниками рынка и по временному охвату решений, приня-
тых в каждом из секторов: сектор регулируемых договоров, сектор свободных двухсторон-
них договоров, рынок на сутки вперед и балансирующий рынок, где идет покупка / продажа
объемов отклонений электроэнергии, регулируемая АТС.

Далее рассматриваться будет именно взаимодействие в рамках рынка на сутки вперед.
Моделировать имеет смысл именно этот рынок, потому что сектора регулируемых договоров
и свободных двусторонних договоров слишком примитивны, а балансирующий рынок уст-
роен так, что поставщикам и покупателям всегда выгодно выполнять просьбу администрато-
ра торговой системы и стараться минимизировать собственные отклонения, что и является
их оптимальным поведением.

Объемы электроэнергии, не покрываемые регулируемыми договорами и свободными
двухсторонними договорами, реализуются на рынке на сутки вперед (РСВ). РСВ представля-
ет собой проводимый коммерческим оператором (ОАО «АТС») конкурентный отбор цено-
вых заявок поставщиков и покупателей за сутки до реальной поставки электроэнергии с оп-
ределением цен и объемов поставки на каждый час суток °. На PCB цена в каждом узле опре-
деляется путем балансирования спроса и предложения и распространяется на всех участни-
ков рынка, отнесенных к конкретному узлу. Цена РСВ определяется для каждого из узлов
в двух ценовых зонах. Индексы цен и объемы торговли РСВ публикуются в ежедневном ре-
жиме на сайте ОАО «АТС». Для снижения рисков манипулирования ценами на РСВ введена
система стимулирования участников к подаче конкурентных ценовых заявок. В соответствии
с правилами торговли, в первую очередь удовлетворяются заявки на поставку электроэнер-
гии с наименьшей ценой °. АТС формирует цены на PCB, максимизируя функцию благосо-
стояния, отражающей общий выигрыш от участия в рынке на сутки вперед. Равновесные
цены определяются АТС механически, все задано формулами, отраженными в официальной
документации “. В рамках PCB поставщики и покупатели передают ATC ступенчатые цено-
вые заявки с указанием объемов и цен, по которым они готовы продать / купить электроэнер-
гию. Ступенчатые ценовые заявки позволяют передать АТС несколько цен и разные объемы
для каждой цены от одного агента, при которых он готов торговать на РСВ. Информация пе-
редается до 11.00 дня, предшествующего производству и потреблению электроэнергии, ука-
занной в ценовых заявках. До 16.00 того же дня АТС сообщает каждому агенту сложившую-
ся для него равновесную цену и объем производства / потребления электроэнергии.

Поставщик при установлении цены не обращает внимания на постоянные издержки, так
как их компенсируют на оптовом рынке мощности. Компания продает мощности (обязатель-
ство поддерживать генерирующее оборудовании в состоянии готовности к производству
электроэнергии), и при установлении цены на мощность поставщик учитывает все остальные
затраты, кроме топлива.

Модель
Обзор

Обоснование. Объект исследования — оптовый рынок электроэнергии. В данной работе
будет рассматриваться взаимодействие покупателей и поставщиков в рамках рынка на сутки
вперед на оптовом рынке электроэнергии.

Агентами в данной модели будем считать поставщиков, покупателей и АТС.

> Технологическое обеспечение работы оптовых рынков URL http //so-ups ru/71d=5 (дата обращения 20 05 2015)

3 Отчет «Анализ ценовой ситуации Ha PCB в январе-феврале и первые недели марта 2012 года» URL www
np-sr ru/n/SR_0V022960 (дата обращения 20 05 2015)

‘ Регламент проведения конкурентного отбора ценовых заявок на сутки вперед URL http /Avww np-sr ru/ regu-
lation/joming/reglaments/index htm?ssF olderld=54 (дата обращения 25 05 2015)


--- Страница 5 ---

74 Микроэкономический анализ: методы и результаты

Ограничения. В данной модели у поставщиков нет возможности продавать электроэнер-
гию потребителям по всей стране ввиду ограничений сетей по мощности, взаимодействие
происходит лишь с потребителями, которые расположены близко к поставщику. Поэтому
рассматриваться будут лишь те агенты, которые расположены во второй ценовой зоне (Си-
бирь). Также у поставщиков нет возможности значительно наращивать производство элек-
троэнергии ввиду их ограничений по мощности. У агентов нет возможности перемещаться
в пространстве.

Отношения агеитов и их действия. В рамках рынка на сутки вперед поставщики и поку-
патели подают ценовые заявки, т. е. сообщают АТС объемы электроэнергии и цены, по кото-
рым они готовы ее купить / продать. Собрав все ценовые заявки, АТС определяет равновес-
ные цены и объемы производства электроэнергии, определяет, чьи ценовые заявки будут
удовлетворены, и сообщает им об этом.

Концепция

Время в модели измеряется в часах (один шаг — один час). В реальности каждый час пара-
метры, характеризующие агентов (объемы и цены), разнятся, поэтому обучение идет для ка-
кого-то одного среднего часа каждого дня. Следовательно, агенты принимают решение мо-
ментально, а длина между концом шага f и началом шага {+1 равна 23 часам.

Протоколы взаимодействия и информационные потоки.

Ниже представлены протоколы, отражающие действия агентов на каждом шаге:

Агенты Действия и информация

Подают ценовые заявки (цена и объем индивидуального предложения)
Поставщики

АТС
Покупатели Подают ценовые заявки (цена и объем индивидуального спроса) АТС

Определяет равновесные цены и объемы для каждого поставщика и поку-

АТС
пателя и сообщает это им

Прогнозирование. Поставщики и покупатели прогнозируют ожидаемую прибыль для при-
нятия решения о действии на следующем шаге.

Принятие решений. В качестве потребителей в данной модели будут рассматриваться
энергосбытовые компании, чьей деятельностью является перепродажа электроэнергии на
розничном рынке. Таким образом, потребители формируют свои ценовые заявки, ставя перед
собой цель максимизации прибыли. В качестве другой группы потребителей рассматривают-
ся крупные производства. Они максимизируют свой выигрыш от того, что они покупают
электроэнергию на оптовом, а не на розничном рынке. Таким образом, целевые функции
у всех покупателей выглядят одинаково: как разница между оптовой и розничной ценой, ум-
ноженная на объем. Покупатели чаще всего подают ценопринимающие заявки ввиду неэла-
стичного спроса на розничном рынке.

Поставщики формируют свои ценовые заявки, также ставя перед собой цель максимиза-
ции прибыли, которая рассчитывается как объем, умноженный на разницу между оптовой
ценой и переменными средними издержками. Следует отметить, что крупные поставщики
зачастую обязаны подавать ценопринимающие заявки.

АТС формирует цену на РСВ на пересечении совокупных кривых спроса и предложения.
Равновесные цены определяются АТС механически, все задано формулами, описанными
в спецификации модели.

Обучение. Поставщики и покупатели обучаются по алгоритму Эрева - Рота [16]. АТС не
обучается. Сразу отметим, что такое обучение возможно, если правила агентов дискретны,
т. е. каждый агент имеет несколько наборов цена-объем и выбирать он может только из этого
набора.


--- Страница 6 ---

Рашидова Е. А. Агенториентированное моделирование оптового рынка электроэнергии 75

Появление новых агентов или выбытие старых. Число агентов строго ограничено, только
СО решает, кто имеет право являться участником рынка. В модели их число предполагается
постоянным.

Как случайные события влияют на модель. Случайные события могут быть введены до-
полнительно после построения модели.

Поиск данных

Прежде чем описывать саму математическую модель, необходимо пояснить, каким обра-
зом для нее адаптированы реальные данные. Так как было решено проводить моделирование
второй ценовой зоны (Сибирь), необходимо определить количество реально существующих
поставщиков и покупателей, а также сымитировать правдоподобные параметры их спроса
и цен.

В 2015 г. в Сибири действовало 66 электростанций, однако фактически удалось найти ин-
формацию о деятельности лишь 53 электростанций °. Зададим максимальный и минималь-
ный объем производства электроэнергии электростанциями, ориентируясь на данные об объ-
емах производства поставщиков, которые были взяты с сайтов поставщиков и новостных
лент. Напомним, что это лишь симуляция реальных явлений. Максимальный объем произ-
водства имитированных данных совпадает с фактическим максимальным объемом производ-
ства за 2015 г. Кроме того, необходимо определить минимальную и максимальную цену,
которую могут указать производители в заявке. Максимальная цена в 2015 г. составила
1200 руб./МВт-ч. Для всех агентов примем эту цену за максимальную. Минимальная цена —
это 0 руб./МВт-ч. Другими словами, производитель готов продать электроэнергию по любой
равновесной цене, он уверен в том, что его заявка пройдет, и он не хочет рисковать и уста-
навливать высокую цену. Устанавливая высокую цену, производитель рискует проиграть
аукцион, но в случае, если спрос окажется велик и его заявка пройдет, он может повысить
уровень равновесной цены, что увеличит его прибыль. Однако есть небольшие электростан-
ции, которым не выгодно работать при любой цене. Поэтому у части агентов с небольшим
максимальным объемом минимальная цена будет больше 0. Также некоторые крупные элек-
тростанции всегда подают ценопринимающие заявки, поэтому их максимальная цена равна
нулю. Примерные цены, которые подают агенты, можно найти в обезличенных заявках,
опубликованных ATC °. Для расчета прибыли продавцов необходимо знать себестоимость
производства электроэнергии каждой из электростанций. На ГЭС она не превышает 0,2 руб.
за киловатт-час. На ТЭЦ и ГРЭС, работающих преимущественно на угле, она составляет
от 0,5 до 1,5 руб. за киловатт-час. На электростанциях, как и в другом производстве, действу-
ет эффект от масштаба. Поэтому чем крупнее электростанция, тем ниже средние издержки.
Зададим средние издержки для каждого агента в указанных выше границах с учетом эффекта
от масштаба.

Что касается покупателей, то в Сибири они всегда подают ценопринимающие заявки,
а значит, ничем не различаются при торговле на оптовом рынке. Всего на оптовом рынке
во второй ценовой зоне имеется 21 покупатель. Их суммарный объем варьируется примерно
от 17 000 до 30 000 МВт-ч. Для расчета их прибыли необходимы цены на розничных рынках
электроэнергии. Выкупленный объем на оптовом рынке продается разным группам покупа-
телей на розничном рынке. Для каждой группы покупателей на розничном рынке устанавли-
вается своя цена таким образом, чтобы средневзвешенная по объемам розничная цена была
выше оптовой цены. Розничная цена для населения всегда ниже, чем оптовая. Поэтому
успешность энергосбытовых компаний зависит OT цен и объемов электроэнергии, покупае-
мой юридическими лицами. Спрос со стороны физических лиц с течением времени изменя-
ется незначительно, в отличие от спроса со стороны юридических лиц. В связи с этим сред-
невзвешенная цена всегда колеблется. Определим ожидаемую средневзвешенную цену, ба-

> Информация об основных параметрах расчетных моделей электроэнергетической системы URL http //so-
ups ru/fileadmin/files/company/reports/disclosure/2015/model_ups_0115 pdf (дата обращения 18 03 2016)

$ Отчет о параметрах спроса и предложения URL http /Avww atsenergo ru/nreport?mame=curve_demand_offer
(дата обращения 03 03 2016)


--- Страница 7 ---

76 Микроэкономический анализ: методы и результаты

зируясь на известных розничных ценах по Сибири. Порядка 20 % потребления приходится
на население и группы потребителей, приравненных к нему. Около 70 % идет на остальных
потребителей, и потери составляют около 10%’. Что касается цен, то одноставочный тариф
для населения (в среднем) составляет около 400-700 руб./МВт-ч, а для остальных потребите-
лей достигает 2 300 руб./МВт-ч. Предполагается, что покупатели одинаковые, следовательно,
зная границы совокупного спроса *, можно обозначить границы индивидуального спроса.

Таким образом, был создан набор агентов (53 поставщика и 21 покупатель) с реалистич-
ными параметрами. Дополнительно (для сравнения) создадим набор агентов, которые не вы-
нуждены подавать ценопринимающие заявки.

Сиецификация модели

Каждый агент представляет информацию о том, какие минимальные и максимальные це-
ны (Ри и Р„)и объемы (Они О) он может указывать в ценовой заявке, средние из-

держки производства C (для агентов, являющихся поставщиками) и ожидаемая розничная
цена г (для агентов, являющихся покупателями). На основании этой информации опреде-
ляются правила агентов, ожидаемые прибыли Г для каждого правила J в момент времени

tf и подаваемые заявки. Каждому из агентов-поставщиков присвоен номер от | до 53,
покупателям — от 1 до 21. АТС представляет собой формулу формирования совокупных
спроса и предложения из индивидуальных, а затем формулу расчета индивидуальных
равновесных объемов (прилож. 1). На рис. | представлена схема, по которой происходит
взаимодействие агентов на каждом шаге.

Теперь перейдем к формальному описанию происходящего. До начала функционирования
механизма, в момент времени / =0 для каждого агента правила задаются:

. номером правила / (от | до J);

* ценой Р, и объемом О,, соответствующими правилу;

. ожидаемой прибылью TT.
У нас имеются диапазоны цен и объемов агентов. Исходя из этого зададим порядок
определения дискретных правил (Р.О, для 7 от 1 до J следующим образом:

Р-Р
Р, = Pam tp для, =0,...,Кь,
Р
О ах — От
Ко

А потом формируем из них пары сочетаний каждой цены с каждым объемом и нумеруем от 1
до J (J=K>,Ko).

В начале момента времени ¢ поставщикам и покупателям необходимо подать свои цено-
вые заявки (т. е. выбрать одно из правил). Правило, которое будет использовано в период 1,

выбирается случайно с вероятностью, рассчитанной по алгоритму обучения (прилож. 2).
Вероятности выбора правил в начале первого периода (при {= 0) пропорциональны ожидае-

О, = О т + lo

для о =0,...,Ko.

мым прибылям в конце первого периода IT. Для поставщиков она рассчитывается следую-
щим образом:
а для покупателей иначе:

П,=0, ("-Р.„).

7 Струнилин П. В. Рынок электроэнергии в РФ взгляд промышленных потребителей URL http /Awww
proatom ru/modules php? file=article&name=News&sid=2362 (дата обращения 10 04 2015)
$ Отчег о параметрах спроса и предложения


--- Страница 8 ---

Рашидова Е. А. Агенториентированное моделирование оптового рынка электроэнергии 77

Равновесные Равновесные

цены, объемы цены, объемы

ценовые за- ценовые за-

|
|
|
|
|
' И исходные
|
|
|
|
|

I
I
|
|
|
' И исходные
|
I
I
I
|

Равновесные цены
и объемы

=== -

: Модуль поиска равновесных цен

Ринининие"

Рис. 1. Схема взаимодействия агентов

Все происходящее далее повторяется для каждого ¢ от 1 до Т.
v > 1
1. Каждый агент случайным образом выбрал какое-то правило с номером К’, т.е. подал

заявку (P QO). Распределение правил является дискретным с вероятностями, которые

рассчитываются в соответствии с алгоритмом Эрева — Рота (см. прилож. 2) в предыдущий
момент времени на основе склонности выбора 9. 3

2. ATC собрал заявки со всех агентов и строит функции совокупного спроса и пред-
ложения, а затем отправляет их в модуль поиска равновесных цен (см. прилож. 1). На пере-
сечении кривых спроса и предложения определяются равновесный объем (объем покупки /
продажи электроэнергии) и равновесная цена для всех сделок по купле-продаже электро-
энергии в заданный час. Поставщики, предлагающие цену выше равновесной, и покупатели,
предлагающие цену ниже равновесной, в торгах не продают и не покупают электроэнергию
в этот час. Графически это изображено на рис. 2.

3. Далее АТС получает Р’(равновесная цена для всего объема) и О` (совокупный объем),
определяет равновесные объемы для каждого агента. Затем АТС передает каждому агенту
информацию о его объеме 4’ и об общей равновесной цене Р’, на основании которых они
считают свою реальную прибыль.


--- Страница 9 ---

78 Микроэкономический анализ: методы и результаты

Равновесная
цена для всего
объема

Рис. 2. Поиск равновесия

Для поставщиков (в векторном виде) она рассчитывается так:
п =q (Р -C),
а для покупателей так:
п =q (r-P’).
4. Теперь, зная выбранное правило, свою прибыль и склонность выбора (5,) правила }
в текущий момент времени 1, агент отправляет эту информацию в обучающий модуль и по-
лучает информацию о новом распределении правил (новых вероятностях, которые пропор-
циональны новым склонностям si ). Таким образом, в модели используется алгоритм обу-
чения, который был создан Ротом и Эревом [17] (алгоритм описан в прилож. 2).
Дальше все повторяется заново: каждый агент случайным образом выберет какое-то пра-
вило с номером К’".

Экспериментальные расчеты

Компьютерная симуляция будет проводиться для двух массивов входных данных:

1) когда агенты вынуждены подавать ценопринимающие заявки;

2) когда агенты могут подавать любые заявки.

Для того чтобы понять, кто в большем выигрыше (потребители или производители) будем
сравнивать такие показатели, как совокупная прибыль поставщиков:

GP =n! = У ба (P’ - С,),

совокупная прибыль покупателей:

СР=У, „бя! = ed `("- P’),

ТР =GP+CP.

общая прибыль всех агентов:


--- Страница 10 ---

Рашидова Е. А. Агенториентированное моделирование оптового рынка электроэнергии 79

Длина каждой симуляции равна 365 шагам (365 раз устанавливается новое равновесие).
Сначала взглянем на то, как ведут себя цены и объемы (рис. 3).

Колебания ряда цены, если заявки можно было подавать любые, гораздо меньше, и цена
в итоге устанавливается более низкая. Что касается объемов, то поначалу при любых заявках

он значительно ниже, чем при ценопринимающих, однако в долгосрочной перспективе объ-
емы выравниваются.

+
io)
©
Oo

т
Ea
-
[aa]
=
hry
о
>
5
-
с
=
@
=

em ||енопринимающие заявки Любые заявки
а
30000
ety PREPS О о oy Pi ory aps
25000
a
# 20000
са
= 15000
=
2
9 10000
о
5000
0
жошго но ыы, гоэзо о гонок о-ямоыиугон-миогоан-
ччоз;зогоаоссаоя,я,юооа-н-наз,оюго на яязо
Ad аа аа а ааа аа ааа о мяю мэдоэ
t
—— LleHonpuHumalouwne заявки КЛюбые заявки
6

Puc. 3. Динамика равновесных цен (а) и объемов (6)

Теперь посмотрим, есть ли разница в целом. Обратимся к графикам общей прибыли, ко-
торую получили в совокупности (рис. 4). Динамика общей прибыли напоминает динамику
общего объема: сначала для ценопринимающих заявок прибыль выше, однако со временем
она выравнивается. И, наконец, посмотрим, как подача преимущественно ценопринимающих
заявок скажется на распределении выигрыша между поставщиками и покупателями (рис. 5).


--- Страница 11 ---

80 Микроэкономический анализ: методы и результаты

40000000

35000000 УЧ ЧИ

2 30000000 И as cae a
25000000
20000000
15000000
10000000
5000000
0

5
5
4

Wo
=
2
Е
&
G
Е

te)

о

=== ||енопринимающие заявки Любые заявки

Рис. 4. Динамика общей прибыли поставщиков и покупателей

% выигрыша покупателей от общего
выигрыша

Ценопринимающие заявки Любые заявки

Рис. 5. Динамика доли выигрыша покупателей

Доля покупателей в общем выигрыше достаточно сильно зависит от того, можно ли пода-
вать любые заявки. И если да, то их доля будет около 60 %, иначе она составит лишь немно-
rum более 40 %.

Заключение

В результате описания и анализа рынка электроэнергии стало ясно, что моделировать
имеет смысл именно рынок на сутки вперед. Это так, потому что сектора регулируемых до-
говоров и свободных двусторонних договоров слишком примитивны, а балансирующий ры-
нок устроен так, что поставщикам и покупателям всегда выгодно выполнять просьбу адми-
нистратора торговой системы и стараться минимизировать собственные отклонения, что
и является их оптимальной стратегией. Хотя в дальнейшем возможно одновременное моде-
лирование рынка на сутки вперед и балансирующего рынка при предположении о том, что
какой-либо агент может с достаточной степенью уверенности предсказать цены на рынке


--- Страница 12 ---

Рашидова Е. А. Агенториентированное моделирование оптового рынка электроэнергии 81

на сутки вперед и то, в какую сторону от планового производства администратор торговой
системы попросит этого агента отклониться. В таком случае агентом может быть избрана
стратегия, которая не будет совпадать со стратегией, указанной выше.

При изучении проведенных ранее исследований подтвердилось предположение о том, что
имеет смысл моделировать именно рынок на сутки вперед. Было обнаружено, что генетиче-
ским алгоритмам при агент-ориентированном моделировании рынка электроэнергии предпо-
читают алгоритмы обучения с подкреплением. Также выяснено, что моделируются в качест-
ве агентов в основном поставщики. В модели, которая строится в данной работе, учитывают-
ся и покупатели. Кроме того, агент-ориентированных моделей рынка электроэнергии России
пока нет, что подтвердило важность проводимого исследования.

На этапе сбора и адаптации реальных данных стало известно о том, что необходимая ин-
формация является коммерческой тайной компаний. Таким образом, было принято решение
о сборе всей доступной информации и имитации данных, приближенных к реальным, на ее
основании. Подтверждением корректности имитации данных является динамика равновес-
ной цены, полученная в результате первой компьютерной симуляции, которая является ос-
новной. В целом, она совпадает со средним уровнем цены во второй ценовой зоне. То же са-
мое можно сказать и о среднем объеме.

Были проведены две симуляции построенной модели (для двух массивов данных) и сде-
лано несколько наблюдений.

1. Если агенты, за исключением некоторых поставщиков, подают ценопринимающие за-
явки, равновесная рыночная цена увеличивается.

2. Если агенты, за исключением некоторых поставщиков, подают ценопринимающие за-
явки, доля выигрыша покупателей снижается почти на 20 %.

3. Если агенты могут подавать любые заявки, колебания цены снижаются.

4. Если агенты могут подавать любые заявки, уровень общей прибыли и объема произ-
водства в долгосрочной перспективе станут такими же, как если бы агенты, за исключением
некоторых поставщиков, подавали ценопринимающие заявки.

Сделанные наблюдения позволяют предположить, что разрешение агентам, которые спо-
собны обучаться, подавать любые заявки позволило бы покупателям приобретать тот же
объем по более низкой цене и, таким образом, перераспределять общественный выигрыш
в пользу покупателей, а потенциально может увеличиться и выигрыш розничных потребите-
лей (физические и юридические лица).

В завершение можно обозначить дальнейшие возможности развития и использования
данной модели. Когда начался процесс моделирования, стало ясно, что алгоритм Эрева — Ро-
та должным образом не отражает обучение каждому правилу в отдельности, т. е. не понятно,
насколько агент уверен в выигрыше при выборе правила. Кроме того, обучение происходит
достаточно медленно. Поэтому необходимо модифицировать алгоритм Эрева — Рота таким
образом, чтобы решить указанные проблемы.

Слисок литературы

1. Hobbs В. Е., Metzler С. B., Pang J. 5. Strategic gaming analysis for electric power systems:
an mpec approach // IEEE Transactions on Power Systems. 2000. Vol. 15. Ne 2. P. 638-645.

2. Лисин Е. М., Стриелковски B., Григорьева А. H., Анисимова FO. А. Современные подхо-
ды к разработке моделей рынков электроэнергии и исследованию влияния рыночной силы на
конъюнктуру энергорынка // Вектор науки ТГУ. 2013. № 1 (23). С. 188-197.

3. Макаров В. Л., Бахтизин А. Р. Новый инструментарий в общественных науках — агент-
ориентированные модели: общее описание и конкретные примеры // Экономика и управле-
ние. 2009. № 12. С. 13-25.

4. ВопаБеаи Е. Agent-based modeling: Methods and techniques for simulating human systems.
National Academy of Science, 2002.

5. Wooldridge M., Jennings N. Intelligent agents: Theory and practice // Knowledge Engineer-
ing Review. 1995. Vol. 10. Ne 2.

6. Li Н., Tesfatsion Г. The AMES wholesale power market test bed: a computational laboratory
for research, teaching and training. Iowa State University, Ames, 2009.


--- Страница 13 ---

82 Микроэкономический анализ: методы и результаты

7. Nicolasen J., Smith M., Petrov V., Tesfatsion Г. Concentration and capacity effects оп elec-
tricity market power. Proceeding of the 2000 Congress on Evolutionary Computation, La Jolla.
USA, 2000. Р. 1041-1047.

8. Nicolaisen J., Petrov V., Tesfatsion L. Market power and efficiency in a computational elec-
tricity market with discriminatory double-auction pricing // IEEE Transactions on Evolutionary
Computation. 2001. Vol. 5. № 5. P. 504—523.

9. Bower J., Bunn D.W. Model-based comparison of pool and bilateral markets for electricity //
Energy Journal. 2000. Vol. 21. Ne 3. P. 1-21.

10. Bower J., Bunn D.W., Wattendrup C. A model-based analysis of strategic consolidation in
the German electricity industry // Energy Policy. 2001. Vol. 29. Ne 12. Р. 987-1005.

11. Weidlich A., Veit D. Bidding in interrelated day-ahead electricity markets: Insights from an
agent-based simulation model // Proc. of the 29" IAEE Intemational Conference. Potsdam, 2006.

12. Weidlich А., Veit D. A critical survey of agent-based wholesale electricity market models //
Energy Economics. 2008. Vol. 30. Ne 4. P. 1728-1759.

13. Bower J., Bunn D. И’. Experimental analysis of the efficiency of uniform-price versus dis-
criminatory auctions in the England and Wales electricity market // Journal of Economic Dynamics
and Control. 2001. Vol. 25. № 3—4. Р. 561-592.

14. Zhou Z., Chan И’. K., Chow J. H. Agent-based simulation of electricity markets: a survey of
tools // Artificial Intelligence Review. 2007. Vol. 28. Ne 4. P. 305-342.

15. Liu Z., Yan Л, Shi Y., Zhu K., Pu а. Multi-agent based experimental analysis on bidding
mechanism in electricity auction markets // International Journal of Electrical Power & Energy Sys-
tems. 2012. Vol. 43. Ne 1. P. 696-702.

16. Erev L, Roth A. Е. Predicting how people play games: Reinforcement learning in experi-
mental games with unique, mixed strategy equilibria // The American Economic Review. 1998.
Vol. 88. № 4. P. 848-881.

17. Roth A. E., Erev I. Learning in extensive-form games: experimental data and simple dynam-
ic models in the intermediate term // Games and Economic Behavior. 1995. Ne 8. P. 164—212.

Материал поступил в редколлегию 24.11.2016

Приложение 1
Алгоритм поиска равновесной цены и объема

Пусть сЕ{1,..., N.} — это номера покупателей, ве {1,..., N,} — это номера поставщиков
электроэнергии. Ценовые заявки покупателей, поданные администратору торговой системы,
обозначаются как (р’, g°) для 7 от 1 до №. , а поставщиков — (р*, 4“) для 1 от 1 до N,.

При построении совокупного спроса пары цена-объем от покупателей упорядочиваются
по цене р, (от максимальной к минимальной). Теперь максимальной цене присвоено

обозначение Р°, следующей по величине — Py ит. д. (минимальной — Py. ).
Тогда совокупный спрос, при Ох. = Уса: ‚ равен
0, Р> Р°
QO = 0, Г >Р>Ри1ЕЦ,..., №},
Ох. ‚ Py. =P>0
где PY > Py Pe Py

Аналогично строится и кривая совокупного предложения, HO цены упорядочиваются
от минимальной к максимальной:


--- Страница 14 ---

Рашидова Е А. Агент-ориентированное моделирование оптового рынка электроэнергии

0, РЗ >Р

0: =. 01, Р8 > P=P®,ie{L..., Ng},

1+1 1

с 5
Oy. РР

где Р* < Ps <... <.
Пусть ke[1;...;N.], ИЕ[1;...; Мс]. Если найдутся такие К и и, что выполняется

О, 20,

P8, > Po > Ps

n+l
TO равновесный объем O =Q%,auena P =P’.
В противном случае О =Q7,a P =P* anataxux К и и, что
О, <Q,
Ps > РЕ > Py,
Затем найденный О’ проверяется на допустимость:
О =min {2 ‚Ох. }
* _ : g с * _ pe
Q = тт {0,05 \ Pp = Py.

Далее определяются равновесные объемы для каждого агента. Для поставщиков:

on = с, OF <Q
* * >
© (Q-Q8,, OF >Q
Ч, у = oF ~ ae
где О =4# =0.
Для покупателей
O° — О’, О’ <Q
* *>
© © -Q),.07>9
q, =9 -Q",

где on = qe =0.

83

В итоге упорядочиваем полученные равновесные объемы по номерам агентов и получаем

4* для Гот | до М.и 49° для тот 1 до М. , которые АТС сообщает каждому агенту.

Приложение 2

Алгоритм Эрева — Рота

Пусть J - количество возможных действий (в данном случае это наборы стандартных

ценовых заявок). Тогда 7 — некоторое действия из набора (1,...,7), а k’ - действие из на-

бора (1,..., 7), совершенное в периоде 1. Склонность выбрать любое действие / в периоде

t+] вычисляется следующим образом:


--- Страница 15 ---

84 Микроэкономический анализ: методы и результаты

R™ (1-е), =k’
t+1 _ . t
5, = (1 f)- Si + St. e
J J-l
где Г - это параметр новизны (насколько сильно агент предпочитает не выбирать действие,

ук”

как в предыдущем периоде); е — параметр эксперимента (насколько сильно агент любит
применять пробные действия для наращивания собственного опыта); К - это и есть под-

крепление. Оно может вычисляться как В" =п'-п где п — это выигрыш в предыдущем

min?
периоде, а п — это наименьший возможный выигрыш.
Тогда вероятность выбора действия / считается следующим образом:

1+1
5,

J 1 °
2.5,

Рот и Эрев предлагают использовать следующие параметры: f =0,1; е=0,2. В качестве

P, =

склонности 5, будет взята ожидаемая прибыль в первом периоде IT.

Для поставщиков п„„ определяется следующим образом:

Па = Min {Ох (Ри —C)3 Ош (Ри -С); 0},
а для покупателей

Tan = min {Qn (7 = Pax 5 Оша ("-Р=);0}.

Е. А. Rashidova

Novosibirsk State University
1 Pirogov Str., Novosibirsk, 630090, Russian Federation

lizarashidova@gmail.com
AGENT-BASED MODELING OF WHOLESALE ELECTRICITY MARKET

The article investigates the free electricity market via agent-based modeling. The aim is to create
a simple and quite plausible simulation model of the market, where suppliers and buyers, participat-
ing in the bilateral auction, learn to submit the most profitable bids. Whereas this kind of simulation
models has been developed for the EU and USA markets by foreign researchers, for the Russian
market they have not been made yet. The suggested theoretical agent-based model of interaction in
the day-ahead market uses Erev and Roth learning algorithm and allows us to calculate and analyze
equilibrium price, volume, social welfare and its distribution between buyers and sellers of electrici-
ty. The modeling demonstrates that it is possible to lower prices and redistribute social welfare in
favor of buyers, provided that the learning agents can submit any bids.

Keywords: agent-based modeling, learning agents, wholesale electricity market, day-ahead mar-
ket.

References

1. Hobbs B. F., Metzler C. B., Pang J. S. Strategic gaming analysis for electric power systems:
an mpec approach. JEEE Transactions on Power Systems, 2000, vol. 15, no 2, р. 638—645.

2. Lisin E. M., Strielkovski V., Grigor'eva A. N., Anisimova Ju. A. Sovremennye podhody
К razrabotke modelej rynkov elektroenergii 1 issledovaniju vlijanija rynochnoj sily na konjunkturu
energorynka [Modern approaches to modeling electricity markets and studying of the market forc-


--- Страница 16 ---

Рашидова Е. А. Агенториентированное моделирование оптового рынка электроэнергии 85

es’ influence on the situation on the energy market]. Vektor паи TGU[Science vector TSU], 2013,
no. | (23), p. 188-197.

3. Makarov У. L., Bahtizin A. К. Novyj instrumentarij у obshestvennyh naukah — agent-
orientirovannye modeli: obshee opisanie 1 konkretnye primery [New tools in the social sciences —
agent-based models: general description and specific examples]. Ekonomika 1 upravlenie [Econom-
ics and management], 2009, no. 12, р.13-25.

4. Bonabeau E. Agent-based modeling: Methods and techniques for simulating human systems.
National Academy of Science, 2002.

5. Wooldridge M., Jennings N. Intelligent agents: Theory and practice. Knowledge Engineering
Review, 1995, vol. 10, no 2.

6. Li H., Tesfatsion L. The AMES wholesale power market test bed: a computational laboratory
for research, teaching and training, lowa State University, Ames, 2009.

7. Nicolaisen J., Smith M., Petrov V., Tesfatsion L. Concentration and capacity effects on elec-
tricity market power. Proceeding of the 2000 Congress on Evolutionary Computation, La Jolla,
USA, 2000, р. 1041-1047.

8. Nicolaisen J., Petrov V., Tesfatsion L. Market power and efficiency in a computational elec-
tricity market with discriminatory double-auction pricing. ZEEE Transactions on Evolutionary
Computation, 2001, vol. 5, no 5, р. 504-523.

9. Bower J., Bunn D. W. Model-based comparison of pool and bilateral markets for electricity.
Energy Journal, 2000, vol. 21, no 3, p. 1-21.

10. Bower J., Bunn D.W., Wattendrup C. A model-based analysis of strategic consolidation in
the German electricity industry. Energy Policy, 2001, vol. 29, по 12, р. 987-1005.

11. Weidlich A., Veit D. Bidding in interrelated day-ahead electricity markets: Insights from an
agent-based simulation model. Proceedings of the 29” IAEE International Conference, Potsdam,
2006.

12. Weidlich A., Veit D. A critical survey of agent-based wholesale electricity market models.
Energy Economics, 2008, vol. 30, no 4, p. 1728-1759.

13. Bower J., Bunn D. W. Experimental analysis of the efficiency of uniform-price versus dis-
criminatory auctions in the England and Wales electricity market. Journal of Economic Dynamics
and Control, 2001, vol. 25, по 3—4, р. 561-592.

14. Zhou Z., Chan W. K., Chow J. H. Agent-based simulation of electricity markets: a survey
of tools. Artificial Intelligence Review, 2007, vol. 28, no 4, р. 305-342.

15. Liu Z., Yan J., Shi Y., Zhu K., Pu G. Multi-agent based experimental analysis on bidding
mechanism in electricity auction markets. International Journal of Electrical Power & Energy Sys-
tems, 2012, vol. 43, no 1, p. 696-702.

16. Erev I., Roth A. Е. Predicting how people play games: Reinforcement learning in experi-
mental games with unique, mixed strategy equilibria. Zhe American Economic Review, 1998, vol.
88, no 4, p. 848-881.

17. Roth A. E., Erev I. Learning in extensive-form games: experimental data and simple dy-
namic models in the intermediate term. Games and economic behavior, 1995, no 8, р. 164-212.

For citation:

Rashidova E. A. Agent-Based Modeling of Wholesale Electricity Market. World of Economics and
Management, 2017, vol. 17, no. 1, p. 70-85. (In Russ.)
